---
title: 'Reproducible Research: Peer Assessment 1'
output:
  html_document:
    keep_md: yes
  pdf_document: default
---


## Loading and preprocessing the data
```{r}
library(dplyr)
activity_data =read.csv("/Users/phukkoo/coursera_reproduceres/project1/activity.csv")
head(activity_data)
names(activity_data)
activity_data_total <- aggregate(steps ~ date, data = activity_data, sum, na.rm = TRUE)
hist(activity_data_total$steps, col = "red",main = " Histogram of Daily Total of Stpes", xlab = " Num of Steps", ylab = "Frequency" )
```



## What is mean total number of steps taken per day?
```{r}
mean(activity_data_total$steps)
median(activity_data_total$steps)
```



## What is the average daily activity pattern?
```{r}
activity_data_avg_by_interval <- aggregate(steps ~ interval, data = activity_data, mean, na.rm = TRUE)
head(activity_data_avg_by_interval)
plot(activity_data_avg_by_interval$interval, activity_data_avg_by_interval$steps, type = "l", xlab = "5-min interval", 
     ylab = "Interval Average  across all Days", main = "Average number of steps taken per Interval", 
     col = "red")

```
### Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?
```{r}
activity_data_avg_by_interval[which.max(activity_data_avg_by_interval$steps),]
```


## Imputing missing values
###  Calculate and report the total number of missing values in the dataset (i.e. the total number of rows with NAs)
```{r}
activity_data_NA <- sum(is.na(activity_data))
```
```{r}
### num of missing values
activity_data_NA 
merge_activity_data <- merge(activity_data, activity_data_avg_by_interval, by.x = "interval", by.y = "interval",all.x=TRUE)  
dim(activity_data_avg_by_interval)
dim(merge_activity_data)
dim(activity_data)
head(merge_activity_data )
merge_activity_data$new_steps <- ifelse(is.na(merge_activity_data$steps.x), merge_activity_data$steps.y,merge_activity_data$steps.x)
head(merge_activity_data )
merge_activity_data_total <- merge_activity_data %>% 
        group_by(date)  %>%
        summarise(total_daily_steps = sum(new_steps ))
hist(merge_activity_data_total$total_daily_steps, col = "green",main = " Histogram of Daily Total of Stpes", xlab = " Num of Steps", ylab = "Frequency" )
```


## Are there differences in activity patterns between weekdays and weekends?
